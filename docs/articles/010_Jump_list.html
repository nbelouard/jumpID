<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>#1: Isolating dispersal jumps and diffusive spread • jumpID</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="#1: Isolating dispersal jumps and diffusive spread">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">jumpID</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/010_Jump_list.html">#1: Isolating dispersal jumps and diffusive spread</a></li>
    <li><a class="dropdown-item" href="../articles/011_Figures_jump_list.html">#1B Creating the figures associated with the jump analysis</a></li>
    <li><a class="dropdown-item" href="../articles/020_Decreasing_calculation_time.html">#2: Decreasing calculation time</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/nbelouard/jumpID/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>#1: Isolating dispersal jumps and diffusive spread</h1>
                        <h4 data-toc-skip class="author">Nadege
Belouard<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;iEco lab at Temple University, Ecobio lab at the
University of Rennes, &lt;a href="mailto:nadege.belouard@gmail.com" class="email"&gt;nadege.belouard@gmail.com&lt;/a&gt;&lt;/p&gt;'><sup>1</sup></a>
</h4>
            
            <h4 data-toc-skip class="date">2024-08-22</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/nbelouard/jumpID/blob/HEAD/vignettes/010_Jump_list.Rmd" class="external-link"><code>vignettes/010_Jump_list.Rmd</code></a></small>
      <div class="d-none name"><code>010_Jump_list.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="aim-and-setup">Aim and setup<a class="anchor" aria-label="anchor" href="#aim-and-setup"></a>
</h2>
<p>The spread of invasive species is due both to diffusive spread and
human-assisted jump dispersal, often caused by species hitchhiking on
vehicles. The aim of this vignette is to differentiate diffusive spread
from jump dispersal in invasive species based on occurrence data. This
identification required the development of a directional analysis of
species presence. We demonstrate this method using occurrence data of
the spotted lanternfly, <em>Lycorma delicatula</em>, an invasive
Hemiptera in the United States.</p>
</div>
<div class="section level2">
<h2 id="data-overlook">1. Data overlook<a class="anchor" aria-label="anchor" href="#data-overlook"></a>
</h2>
<p>The SLF dataset is available from the <a href="https://github.com/ieco-lab/lydemapr" class="external-link"><code>lydemapr</code>
companion package</a>. In the <code>download_data</code> folder, then in
the <code>v2_2023</code> subfolder, download the
<code>lyde_data_v2.zip</code> file and place it in the <code>data</code>
folder of your local <code>jumpID</code> project. At the date at which
this vignette is written, <code>lydemapr</code> contains data up to year
2022.</p>
<p>We load this dataset that contains all the occurrences of the spotted
lanternfly, and take a look at it.</p>
<pre><code><span><span class="co">##   bio_year latitude longitude lyde_established</span></span>
<span><span class="co">## 1     2015 40.41441 -75.65882            FALSE</span></span>
<span><span class="co">## 2     2016 40.33333 -75.63529            FALSE</span></span>
<span><span class="co">## 3     2016 40.36036 -75.48235            FALSE</span></span>
<span><span class="co">## 4     2016 40.36937 -75.62353            FALSE</span></span>
<span><span class="co">## 5     2016 40.37838 -75.71765            FALSE</span></span>
<span><span class="co">## 6     2016 40.47748 -75.62353            FALSE</span></span></code></pre>
<p>The dataset contains 831,039 rows, each corresponding to a SLF survey
at a specific date and location. The columns that we will using
are:<br>
* bio_year: the biological year of the occurrence (see
<code>lydemapr</code> for a description of the difference between year
and bio_year)<br>
* latitude and longitude (XY coordinates). The precise location of SLF
surveys is here summarized in 1-km² cells. All coordinates are in WGS84
(EPSG 4326)<br>
* lyde_established: whether an established SLF population was found in
this survey (at least two live individuals or an egg mass, see
<code>lydemapr</code>)</p>
</div>
<div class="section level2">
<h2 id="data-formatting">2. Data formatting<a class="anchor" aria-label="anchor" href="#data-formatting"></a>
</h2>
<p>First, to use the <code>jumpID</code> package, we need to rename the
columns with generic names expected by the package. We also remove rows
where the SLF establishment is NA.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">slf</span> <span class="op">%&lt;&gt;%</span> <span class="fu">rename</span><span class="op">(</span>year <span class="op">=</span> <span class="va">bio_year</span>,</span>
<span>                established <span class="op">=</span> <span class="va">lyde_established</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">established</span><span class="op">)</span> <span class="op">==</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<p>Second, multiple surveys were sometimes conducted at the same
location during the same year, resulting in a redundant dataset for the
purpose of our analysis. We summarize the information available at each
location every year, so that a row now represents the detection status
at a location for a given year.</p>
<p>Note: when several surveys indicate that SLF are “present” the same
year at the same location, it could be tempting to categorize SLF as
“established”. However, the category “present” often refers to dead
individuals, although this information is not explicitly available. We
use a conservative approach and consider SLF as established in a cell
only if one of the surveys considered it as established.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">grid_data</span> <span class="op">&lt;-</span> <span class="va">slf</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">year</span>, <span class="va">latitude</span>, <span class="va">longitude</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>established <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="va">established</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## `summarise()` has grouped output by 'year', 'latitude'. You can override using</span></span>
<span><span class="co">## the `.groups` argument.</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">grid_data</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 4</span></span></span>
<span><span class="co">##    year latitude longitude established</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>      </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>  <span style="text-decoration: underline;">2</span>014     39.8     -<span style="color: #BB0000;">76.8</span> FALSE      </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>  <span style="text-decoration: underline;">2</span>014     39.8     -<span style="color: #BB0000;">76.3</span> FALSE      </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>  <span style="text-decoration: underline;">2</span>014     39.8     -<span style="color: #BB0000;">76.4</span> FALSE      </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span>  <span style="text-decoration: underline;">2</span>014     39.9     -<span style="color: #BB0000;">76.6</span> FALSE      </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span>  <span style="text-decoration: underline;">2</span>014     39.9     -<span style="color: #BB0000;">76.9</span> FALSE      </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span>  <span style="text-decoration: underline;">2</span>014     39.9     -<span style="color: #BB0000;">76.5</span> FALSE</span></span></code></pre>
<p>The dataset now has 123,532 rows, corresponding to 1280 x 1596 cells.
Let’s look at these data on a map.</p>
<p><img src="010_Jump_list_files/figure-html/create%20US%20map-1.png" width="960"></p>
<p>Cells were predominantly surveyed in the Eastern US, but there are
also cells surveyed in other parts of the US, starting in 2019. Positive
cells (established SLF) are only in the Eastern US, so maps will be
zoomed in on the Eastern US from here.</p>
<p>Every year, there is a large number of cells surveyed with positive
(SLF established) or negative results (SLF not established). A zoomed-in
map allows to see the cell grid.</p>
<p><img src="010_Jump_list_files/figure-html/show%20grid%20map-1.png" width="480"></p>
<p>The progression of the invasion will be measured starting from the
introduction point that has been documented in Barringer et al. 2015. We
store the coordinates of the introduction point in an object for the
next analyses. If the precise introduction point is unknown, it may be
replaced by the centroid of the invasion at the time the invasive
species was discovered in the invasive range.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Coordinates of the introduction site, extracted from Barringer et al. 2015</span></span>
<span><span class="co"># As a table (for distance calculations):</span></span>
<span><span class="va">centroid_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>longitude <span class="op">=</span> <span class="op">-</span><span class="fl">75.675340</span>, </span>
<span>                        latitude <span class="op">=</span> <span class="fl">40.415240</span><span class="op">)</span> </span>
<span></span>
<span></span>
<span><span class="co"># Replace by the centroid of the invasion in the first years of the invasion if the </span></span>
<span><span class="co"># introduction point is unknown:</span></span>
<span><span class="co"># centroid_df &lt;- slf %&gt;% filter(year == 2014) %&gt;%</span></span>
<span><span class="co">#   summarise(latitude = mean(.$latitude),</span></span>
<span><span class="co">#             longitude = mean(.$longitude))</span></span></code></pre></div>
<p>To finish preparing the dataset for analysis, we calculate the
distance between each survey cell and the introduction point.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">grid_data</span> <span class="op">%&lt;&gt;%</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>DistToIntro <span class="op">=</span> <span class="fu">geosphere</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/geosphere/man/distGeo.html" class="external-link">distGeo</a></span><span class="op">(</span><span class="va">grid_data</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'longitude'</span>,<span class="st">'latitude'</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                                                 <span class="va">centroid_df</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'longitude'</span>, <span class="st">'latitude'</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="fl">1000</span><span class="op">)</span> </span>
<span><span class="co"># the distance is obtained in meters, and we divide it by 1000 to obtain kilometers </span></span>
<span><span class="co"># given the scale of this invasion.</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">grid_data</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 5</span></span></span>
<span><span class="co">##    year latitude longitude established DistToIntro</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>  <span style="text-decoration: underline;">2</span>014     39.8     -<span style="color: #BB0000;">76.8</span> FALSE             121. </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>  <span style="text-decoration: underline;">2</span>014     39.8     -<span style="color: #BB0000;">76.3</span> FALSE              83.7</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>  <span style="text-decoration: underline;">2</span>014     39.8     -<span style="color: #BB0000;">76.4</span> FALSE              90.4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span>  <span style="text-decoration: underline;">2</span>014     39.9     -<span style="color: #BB0000;">76.6</span> FALSE             101. </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span>  <span style="text-decoration: underline;">2</span>014     39.9     -<span style="color: #BB0000;">76.9</span> FALSE             121. </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span>  <span style="text-decoration: underline;">2</span>014     39.9     -<span style="color: #BB0000;">76.5</span> FALSE              92.2</span></span></code></pre>
<p>The dataset is now ready for the jump analysis.</p>
</div>
<div class="section level2">
<h2 id="differentiating-diffusive-spread-and-jump-dispersal-principle">3. Differentiating diffusive spread and jump dispersal:
principle<a class="anchor" aria-label="anchor" href="#differentiating-diffusive-spread-and-jump-dispersal-principle"></a>
</h2>
<p>A set of four successive functions will be run to separate cells
where SLF is established due to continuous, diffusive spread, from cells
where SLF is established due to jump dispersal. We will first run the
functions on a tentative set of parameters to understand how the
analysis works. The optimization of the parameters will be described
later in this vignette.</p>
<div class="section level3">
<h3 id="a--attribute_sectors">a- attribute_sectors()<a class="anchor" aria-label="anchor" href="#a--attribute_sectors"></a>
</h3>
<p>Considering that the expansion of the invasion is heterogeneous in
space, the jump analyses requires the invasion range to be divided into
sectors with the introduction site as the origin. The first function,
<code><a href="../reference/attribute_sectors.html">attribute_sectors()</a></code> attributes a sector number to each cell
of the dataset, to be used in the jump analysis. Here, we divide the
invasion range into 16 sectors. See vignette #2 “Decreasing calculation
time” to learn how changing the number of sectors may make your analysis
faster.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">grid_data_sectors</span> <span class="op">&lt;-</span> <span class="fu">jumpID</span><span class="fu">::</span><span class="fu"><a href="../reference/attribute_sectors.html">attribute_sectors</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="va">grid_data</span>, </span>
<span>                                                 <span class="co"># dataset to be explored</span></span>
<span>                             nb_sectors <span class="op">=</span> <span class="fl">16</span>, </span>
<span>                             <span class="co"># number of sectors to divide the invasion range</span></span>
<span>                             centroid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">75.675340</span>, <span class="fl">40.415240</span><span class="op">)</span></span>
<span>                             <span class="co"># vector containing the centroid coordinates as long/lat</span></span>
<span>                             <span class="op">)</span> </span></code></pre></div>
<pre><code><span><span class="co">## 2024-08-22 14:34:47.474122 Start sector attribution... Sector attribution completed.</span></span></code></pre>
<p><img src="010_Jump_list_files/figure-html/map%20attribute%20sectors-1.png" width="960"></p>
<p>The jump analysis will go through each sector successively.</p>
</div>
<div class="section level3">
<h3 id="b--find_thresholds">b- find_thresholds()<a class="anchor" aria-label="anchor" href="#b--find_thresholds"></a>
</h3>
<p>The function <code><a href="../reference/find_thresholds.html">find_thresholds()</a></code> will then search for the
first discontinuity in the SLF distribution. Points are sorted by
increasing distance to the introduction point, and the function goes
through each consecutive pair of points, starting from the introduction
point and going outwards. It stops once it identifies a distance larger
than a defined <code>gap_size</code> between two consecutive points,
marking a discontinuity in the SLF distribution. The last point before
this discontinuity marks the putative limit of the diffusive spread. The
function runs independently for each sector. It is considered that
populations do not go extinct, and data are cumulated over time. The
limit of diffusive spread cannot go back towards the introduction point
over time.</p>
<p>The input dataset is the output of attribute_sectors(). The
<code>gap_size</code> parameter defines the minimal distance between two
consecutive points that marks a discontinuity in the SLF distribution,
in km. In this example, it is set to 15 km.<br>
If the option “negatives” is set to TRUE (default), the function will
check that there are negative surveys in the discontinuity, so that the
absence of SLF established is not due to an absence of surveys in the
area.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gap_size</span> <span class="op">=</span> <span class="fl">15</span> </span>
<span></span>
<span><span class="va">Results_thresholds</span> <span class="op">&lt;-</span> <span class="fu">jumpID</span><span class="fu">::</span><span class="fu"><a href="../reference/find_thresholds.html">find_thresholds</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="va">grid_data_sectors</span>, </span>
<span>                                                gap_size <span class="op">=</span> <span class="va">gap_size</span>, </span>
<span>                                                negatives <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 2024-08-22 14:35:00.539064 Start finding thresholds... Sector 1/16...  2/16...  3/16...  4/16...  5/16...  6/16...  7/16...  8/16...  9/16...  10/16...  11/16...  12/16...  13/16...  14/16...  15/16...  16/16</span></span>
<span><span class="co">## Threshold analysis done. 4243 potential jumps were found.</span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Resulting objects are</span></span>
<span><span class="co">#- Results_thresholds$preDist, a data frame of threshold cells = extreme points of the </span></span>
<span><span class="co"># diffusive spread. Will be completed in find_secDiff()</span></span>
<span><span class="co">#- Results_thresholds$potJumps, a data frame of potential jumps. Will be</span></span>
<span><span class="co"># pruned in find_jumps()</span></span></code></pre></div>
<p><img src="010_Jump_list_files/figure-html/map%20find%20thresholds-1.png" width="960"></p>
<p>On this map, blue points indicate the invasion front identified by
<code><a href="../reference/find_thresholds.html">find_thresholds()</a></code>, i.e., the limits of the diffusive spread
in every direction, for every year. At this point of the analysis, all
points farther than these thresholds are stored as potential jumps
(green points).</p>
</div>
<div class="section level3">
<h3 id="c--find_jumps">c- find_jumps()<a class="anchor" aria-label="anchor" href="#c--find_jumps"></a>
</h3>
<p>The function <code><a href="../reference/find_jumps.html">find_jumps()</a></code> prunes the list of potential
jumps of cells that are less than <gap size> from a positive cell from a
previous year, as the species likely spread from this other cell. The
final list of jumps is obtained in the object <code>Jumps</code>.</gap></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Results_jumps</span> <span class="op">&lt;-</span> <span class="fu">jumpID</span><span class="fu">::</span><span class="fu"><a href="../reference/find_jumps.html">find_jumps</a></span><span class="op">(</span>grid_data <span class="op">=</span> <span class="va">grid_data</span>, </span>
<span>                       potJumps <span class="op">=</span> <span class="va">Results_thresholds</span><span class="op">$</span><span class="va">potJumps</span>,</span>
<span>                       gap_size <span class="op">=</span> <span class="va">gap_size</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 2024-08-22 14:41:08.43217 Start finding jumps... Year 2014 ... Year 2015 ... Year 2016 ... Year 2017 ... Year 2018 ... Year 2019 ... Year 2020 ... Year 2021 ... Year 2022 ... Jump analysis done. 387 jumps were identified.</span></span></code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Resulting objects are:</span></span>
<span><span class="co">#- Results_jumps$Jumps, a data frame containing all jumps</span></span>
<span><span class="co">#- Results_jumps$diffusers, a data frame of positive cells stemming from diffusive spread</span></span>
<span><span class="co">#- Results_jumps$potDiffusion, a data frame of remaining cells, containing a mix of </span></span>
<span><span class="co"># secondary diffusion and additional threshold points. Will be pruned in find_secDiff()</span></span></code></pre></div>
<p><img src="010_Jump_list_files/figure-html/map%20find%20jumps-1.png" width="960"></p>
<p>The analysis may be stopped here if only dispersal jumps are of
biological interest. As a complement, secondary diffusion may be
examined in the last function, <code><a href="../reference/find_secDiff.html">find_secDiff()</a></code>.</p>
</div>
<div class="section level3">
<h3 id="d--find_secdiff">d- find_secDiff()<a class="anchor" aria-label="anchor" href="#d--find_secdiff"></a>
</h3>
<p>Cells that were discarded from the jump list are either additional
threshold points or secondary diffusion from a previous jump.
<code><a href="../reference/find_secDiff.html">find_secDiff()</a></code> attributes them to the correct category by
checking whether they are close from a previous jump, or a diffusion
point.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Results_secDiff</span> <span class="op">&lt;-</span> <span class="fu">jumpID</span><span class="fu">::</span><span class="fu"><a href="../reference/find_secDiff.html">find_secDiff</a></span><span class="op">(</span>potDiffusion <span class="op">=</span> <span class="va">Results_jumps</span><span class="op">$</span><span class="va">potDiffusion</span>,</span>
<span>                                Jumps <span class="op">=</span> <span class="va">Results_jumps</span><span class="op">$</span><span class="va">Jumps</span>,</span>
<span>                                diffusers <span class="op">=</span> <span class="va">Results_jumps</span><span class="op">$</span><span class="va">diffusers</span>,</span>
<span>                                Dist <span class="op">=</span> <span class="va">Results_thresholds</span><span class="op">$</span><span class="va">preDist</span>,</span>
<span>                                gap_size <span class="op">=</span> <span class="va">gap_size</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 2024-08-22 14:41:53.572058 Start finding secondary diffusion... Year 2017 ...Year 2018 ...Year 2019 ...Year 2020 ...Year 2021 ...Year 2022 ...Analysis of secondary diffusion done.</span></span></code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Resulting objects are:</span></span>
<span><span class="co">#- Results_secDiff$secDiff, a data frame of all cells that are secondary diffusion </span></span>
<span><span class="co"># from a previous jump</span></span>
<span><span class="co">#- Results_secDiff$Dist, a data frame of all extreme points on the invasion front (thresholds)</span></span></code></pre></div>
<p><img src="010_Jump_list_files/figure-html/map%20find%20secDiff-1.png" width="960"></p>
</div>
</div>
<div class="section level2">
<h2 id="wrapper-for-jump-analysis">4. Wrapper for jump analysis<a class="anchor" aria-label="anchor" href="#wrapper-for-jump-analysis"></a>
</h2>
<p>All these analyses can be done in one instance using the wrapper
function.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">jumps_wrapper</span> <span class="op">&lt;-</span> <span class="fu">jumpID</span><span class="fu">::</span><span class="fu"><a href="../reference/find_jumps_wrapper.html">find_jumps_wrapper</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="va">grid_data</span>, </span>
<span>                                              nb_sectors <span class="op">=</span> <span class="fl">16</span>,</span>
<span>                                              centroid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">75.675340</span>, <span class="fl">40.415240</span><span class="op">)</span>,</span>
<span>                                              gap_size <span class="op">=</span> <span class="fl">15</span>,</span>
<span>                                              negatives <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 2024-08-22 14:43:16.131378 Start sector attribution... Sector attribution completed. </span></span>
<span><span class="co">## 2024-08-22 14:43:16.164782 Start finding thresholds... Sector 1/16...  2/16...  3/16...  4/16...  5/16...  6/16...  7/16...  8/16...  9/16...  10/16...  11/16...  12/16...  13/16...  14/16...  15/16...  16/16</span></span>
<span><span class="co">## Threshold analysis done. 4243 potential jumps were found. </span></span>
<span><span class="co">## 2024-08-22 14:49:13.378279 Start finding jumps... Year 2014 ... Year 2015 ... Year 2016 ... Year 2017 ... Year 2018 ... Year 2019 ... Year 2020 ... Year 2021 ... Year 2022 ... Jump analysis done. 387 jumps were identified.</span></span>
<span><span class="co">## 2024-08-22 14:49:39.405896 Start finding secondary diffusion... Year 2017 ...Year 2018 ...Year 2019 ...Year 2020 ...Year 2021 ...Year 2022 ...Analysis of secondary diffusion done.</span></span></code></pre>
<p>We plot the results on a map.</p>
<p><img src="010_Jump_list_files/figure-html/map%20results-1.png" width="960"></p>
</div>
<div class="section level2">
<h2 id="rarefy-jump-clusters">5. Rarefy jump clusters<a class="anchor" aria-label="anchor" href="#rarefy-jump-clusters"></a>
</h2>
<p>Some jumps were clustered in the same area. Jump clusters may stem
from independent dispersal jumps, i.e. SLF hitchhiked multiple times to
these locations the same year. Alternatively, jump clusters may result
from SLF quickly spreading around a single dispersal jump. Finally, they
can be a mix between these two hypotheses. We identify these jump
clusters to better understand jump locations.</p>
<p>First, we delineate these jump clusters as jumps located less than
the gap size from each other. Check how many points there are per jump
cluster.</p>
<div class="section level3">
<h3 id="a--group_jumps">a- group_jumps()<a class="anchor" aria-label="anchor" href="#a--group_jumps"></a>
</h3>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Jump_groups</span> <span class="op">&lt;-</span> <span class="fu">jumpID</span><span class="fu">::</span><span class="fu"><a href="../reference/group_jumps.html">group_jumps</a></span><span class="op">(</span><span class="va">Jumps</span>, gap_size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## `summarise()` has grouped output by 'year'. You can override using the</span></span>
<span><span class="co">## `.groups` argument.</span></span>
<span><span class="co">## `summarise()` has grouped output by 'year'. You can override using the</span></span>
<span><span class="co">## `.groups` argument.</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 2</span></span></span>
<span><span class="co">##    year mean_njumps</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>  <span style="text-decoration: underline;">2</span>017        1.5 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>  <span style="text-decoration: underline;">2</span>018        8.29</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>  <span style="text-decoration: underline;">2</span>019        4.23</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span>  <span style="text-decoration: underline;">2</span>020        1.65</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span>  <span style="text-decoration: underline;">2</span>021        2.28</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span>  <span style="text-decoration: underline;">2</span>022        2.41</span></span></code></pre>
<p><img src="010_Jump_list_files/figure-html/plot%20group_jumps-1.png" width="480"></p>
</div>
<div class="section level3">
<h3 id="b--rarefy_groups">b- rarefy_groups()<a class="anchor" aria-label="anchor" href="#b--rarefy_groups"></a>
</h3>
<p>We summarize each jump cluster by summarizing each of them by their
most central point.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Jump_clusters</span> <span class="op">&lt;-</span> <span class="fu">jumpID</span><span class="fu">::</span><span class="fu"><a href="../reference/rarefy_groups.html">rarefy_groups</a></span><span class="op">(</span><span class="va">Jump_groups</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Rarefied <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="010_Jump_list_files/figure-html/map%20jum%20clusters-1.png" width="960"></p>
<p>These <code>387</code> jumps were rarefied into <code>152</code> jump
clusters.</p>
</div>
</div>
<div class="section level2">
<h2 id="data-is-ready-for-biological-analysis-and-interpretation">6. Data is ready for biological analysis and interpretation!<a class="anchor" aria-label="anchor" href="#data-is-ready-for-biological-analysis-and-interpretation"></a>
</h2>
<p>– end of vignette –</p>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nadège Belouard.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
